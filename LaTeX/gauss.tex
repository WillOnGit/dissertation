% This .tex file is simply the statement and proof of Gauss' theorem. To be inserted normally into the main document.
%
% The structure of this proof is fairly convoluted. It can be broken down as follows:
% Introduce homomorphism
% Easy case
% Difficult case
% 	Establish R, S and T
% 	Make initial argument about Mp
% 	Manipulate [RRR]
% 	Introduce Gauss sums
% 	Introduce f(t)
% 	Calculate f(t)
% 	Calculate discriminant (???)
% 	Argue about g(t)
% 	Prove A satisfies the useful conditions

\begin{theorem}
Define $M_p$ to be the number of projective solutions to the equation $x^3 + y^3 + z^3 = 0$ in the field $\fp$. Then,
\begin{itemize}
\item if $p \not\equiv 1 \mod{3}$, then $M_p = p + 1$.
\item otherwise $p \equiv 1 \mod{3}$, and there exist integers $A$ and $B$ such that
	$$4p = A^2 + 27B^2$$
	Since $A^2 \equiv 1 \mod{3}$, $A \equiv \pm1 \mod{3}$. If we fix the sign of A so that $A \equiv 1 \mod{3}$, then
	$$M_p = p + 1 + A$$
\end{itemize}
\end{theorem}

\begin{proof}
The proof of the two separate cases both rely on the same idea, but in the second case requires many more steps before the result is reached, and beginning the proof without an idea of what is to come can make it very hard to understand, as numerous objects are introduced. Therefore we will prove the first case, provide an outline of the proof second case and then finally supply the details.

For both cases, the proof revolves around examining the homomorphism
$$\varphi: \fpu \rightarrow \fpu \qquad x \mapsto x^3$$
Now in the first case, since 3 does not divide the order of $\fpu$, $\varphi$ is bijective, and so an isomorphism. This means that each element of $\fp$ has exactly one cube root. For example, in $\fp[11]$, we have:
\begin{align*}
	0^3 &= 0,\quad
	1^3 = 1,\quad
	7^3 = 2,\quad
	9^3 = 3,\quad
	5^3 = 4,\quad
	3^3 = 5,\\
	8^3 &= 6,\quad
	6^3 = 7,\quad
	2^3 = 8,\quad
	4^3 = 9,\quad
	10^3 = 10.
\end{align*}
This implies that every solution of $x + y + z = 0$ gives exactly one solution of $x^3 + y^3 + z^3 = 0$ by cube rooting each of $x,y,z$. Since $x + y + z = 0$ is the equation of a line in the projective plane, it has exactly $p+1$ solutions. This settles the first case.

Now to outline what happens in the second case.
\begin{itemize}
\item We start off again by examining the homomorphism $\varphi$, and construct three sets $R$, $S$ and $T$ that together make up $\fp$
\item By introducing a new notation, we then establish an initial expression for $M_p$
\item Manipulate this expression
\item Introduce two new objects, ``cubic Gauss sums'' and an as yet unknown polynomial, $f(t)$
\item Calculate $f(t)$ and its discriminant
\item Use this to update our expression for $M_p$ to its final form
\item Prove that the expression has the necessary properties
\end{itemize}
So after getting an initial expression for $M_p$, we basically update it a lot through many smaller arguments, eventually arriving at the one we need.

Since $p \equiv 1 \mod{3}$, 3 divides the order of $\fpu = p-1$, and so $\varphi$ is a homomorphism that is neither injective nor surjective. For example, in $\fp[13]$, we have:
\begin{align*}
	0^3 &= 0\\
	1^3 = 3^3 = 9^3 &= 1\\
	7^3 = 8^3 = 11^3 &= 5\\
	2^3 = 5^3 = 6^3 &= 8\\
	4^3 = 10^3 = 12^3 &= 12\\
\end{align*}
Now, we can introduce our sets $R$, $S$ and $T$. Let
$$R=\{x^3:x\in \fpu\}$$
and let $S = sR$ and $T = s^2R$, where $s$ is any element not in $R$. We now have a partition of $\fp$ as follows:
$$\fp = \{0\} \cup R \cup S \cup T$$
Notice that $\#R = \#S = \#T = m$. Since $-1=(-1)^3$, $-1 \in R$ and $R = -R$, which implies that $S=-S$ and $T=-T$.
Now that we have our partition of $\fp$, we can reason about $M_p$, the object of interest in this proof. First, though, we introduce an important new notation. For $X,Y,Z \subset \fp$:
$$[X,Y,Z] = \#(x,y,z) : x\in X,\quad y\in Y,\quad z\in Z\quad \& \quad x+y+z=0$$
For simplicity, we will sometimes write $[XYZ]$ instead of $[X,Y,Z]$. The symbol $[]$ has a number of useful properties, such as:
\begin{align*}
	[XY(Z\cup W)] &= [XYZ] + [XYW]\quad \si Z\cap W = \emptyset\\
	[XYZ] &= [aX, aY, aZ]\quad \for a\neq0\\
	[XYZ] &= [XZY] = \ldots
\end{align*}
These properties are important and we will use them later to manipulate our initial expression for $M_p$. 

Now, if $xyz\neq0$, then the number of ways of writing $0$ as a sum of non-zero cubes is $[RRR]$, simply by the definitions of the symbol $[]$ and the set $R$. But each element of $R$ has three distinct cube roots, and so there are $(3 \times 3 \times 3) [RRR] = 27[RRR]$ solutions of $x^3 + y^3 + z^3 = 0$ of the form $(x,y,z)$ where $xyz \neq 0$. But since we are working in the projective plane, scalar multiples of the same point are in fact the same point, so we have to divide by $p-1$ for all of the non-zero multipliers of $\fp$, which gives
$$\frac{27[RRR]}{p-1} = \frac{27[RRR]}{3m} = \frac{9[RRR]}{m}$$
projective solutions where $xyz\neq0$.

Now, when one of $x$, $y$ or $z$ is zero, say $x$, neither $y$ nor $z$ can be zero, as either being zero would force the other to also be zero, and the solution $(0,0,0)$ is not allowed in the projective plane. Thus there are $p-1$ choices for $y$, each of which gives three choices of $z$ (by solving $y^3 = -x^3$ and remembering that eachelement has three cube roots), which means there are $3(p-1)$ solutions when $x=0$. The same goes for $y$ and $z$ being zero, so we have a total of $9(p-1)$ solutions where $xyz=0$. However, again, we must divide through by $p-1$, so there are 9 projective solutions when $xyz=0$. This covers all cases, and so we have established that
\begin{equation}
M_p = \frac{9[RRR]}{m} + 9 = 9 \left(\frac{[RRR]}{m}+1\right) \label{g_initial}
\end{equation}
The rest of the proof now relies on modifying this expression until we have the stated result. First of all, we use some properties of $[]$ to simplify \eqref{g_initial}.

To begin with, recall that $\fp = {0} \cup R \cup S \cup T$, a disjoint union. Also, notice that $[RR\fp] = m^2$, since there are $m$ choices for each element of $R$, say $r_1$ and $r_2$, and then let the element of $\fp$ be $-r_1r_2$. Using these two facts, we see that
\begin{equation}
	[RR\{0\}] + [RRR] + [RRS] + [RRT] = m^2 \label{g_manipulate1}
\end{equation}
now fix $s \in S$ and $t \in T$.
$$[RRS] = [sR, sR, sS] = [SST]$$
and likewise, $[RRT] = [TTS]$. Substituting these into \eqref{g_manipulate1}, we have
\begin{equation}
	[RR\{0\}] +[RRR] + [SST] + [TTS] = m^2 \label{g_manipulate2}
\end{equation}
Again using the dijoint union of $\fp$ and $[\fp TS] = m^2$ (for the same reasons as $[RR\fp]$, we have
\begin{equation}
	[\fp TS] = [\{0\}TS] + [RTS] + [STS] + [TTS] = m^2 \label{g_manipulate3}
\end{equation}
Recall that $[STS] = [SST]$. Now notice two things, first, that $[\{0\}TS] = 0$, since $T = -T$, $S = -S$ and $T \cap S = \emptyset$. Secondly, $[RR\{0\}] = m$, since each element of $R$ has exactly one inverse, also in $R$. Combine these observations with substracting \eqref{g_manipulate2} from \eqref{g_manipulate3} and we end up with
\begin{equation}
	[RTS] = [RRR] + m
\end{equation}
Now we can substitute this into our initial expression as follows:
\begin{align*}
	M_p &= 9\left(\frac{[RRR]}{m}+1\right)\\
	    &= \frac{9}{m}\left([RRR] + m\right)\\
	    &= \frac{9[RTS]}{m}
\end{align*}
This is the end of our initial manipulations. We now proceed to use \emph{cubic gauss sums} to find an expression for $[RTS]$. Let $\zeta = e^{2\pi i/p}$, the $p$-th root of unity, and define three complex numbers $\alpha_1$, $\alpha_2$ and $\alpha_3$ as follows:
$$\alpha_1 = \sum_{r\in R} \zeta^r,\quad \alpha_2 = \sum_{s\in S} \zeta^s,\quad \alpha_3 = \sum_{t\in T} \zeta^t$$
These numbers are each a sum of $m$ distinct $p$-th roots of unity, and they are the cubic gauss sums. They also happen to be the three roots of a cubic polynomial $f(t)$, which we now find an expression for. Recall that a general cubic polynomial $G(t)$ in $t$ with roots $\alpha$, $\beta$ and $\gamma$ can be calculated as
$$ G(t) = (t-\alpha)(t-\beta)(t-\gamma) = t^3 - (\alpha + \beta + \gamma)t^2 + (\alpha \beta + \alpha \gamma + \beta \gamma)t - \alpha \beta \gamma $$
For the coefficient of $t^2$, notice that
$$ 0 = \zeta^p -1 = (\zeta - 1)(\zeta^{p-1}+\zeta^{p-2}+\cdots+\zeta+1) $$
and since $\zeta-1 \neq 0$, $(\zeta^{p-1}+\zeta^{p-2}+\cdots+\zeta+1) = 0$. Therefore, $\alpha_1 + \alpha_2 + \alpha_3 = -1$, and the coefficient of $t^2 = 1$.

To find the other coefficients, multiply two of the $a_i$s together, say $\alpha_2$ and $\alpha_3$. Then
$$\alpha_2 \alpha_3 = \sum_{s\in S} \zeta^s \cdot \sum_{t\in T}\zeta^t=\sum_{s \in S, t\in T}\zeta^{s+t} = \sum_{x\in \fp}N_x \zeta^x$$
where $N_x$ is the number of pairs $(s,t)$ with $s \in S$ and $t \in T$ such that $s+t=x$. For $r \in R$, notice that
$$N_x = [ST{-x}] = [rS,rT,{-rx}]=[S,T,{-rx}]=N_{rx}$$
which shows that $N_x$ depends only on the coset $R$,$S$ or $T$ in which $x$ lies.
\end{proof}
